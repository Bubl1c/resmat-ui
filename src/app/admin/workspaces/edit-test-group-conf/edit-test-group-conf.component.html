<div style="display: flex; justify-content: space-between; align-items: baseline;">
  <div class="flex-container">
    <span class="resmat-header resmat-label">Група тестів:&nbsp;&nbsp;</span>
    <editable-text class="resmat-header resmat-regular" style="flex: 5"
                   [text]="workspaceData.data.name"
                   inputPlaceholder="Введіть назву групи"
                   (onSave)="workspaceData.saveTestGroup($event)"></editable-text>
  </div>
  <div class="mui-dropdown">
    <a data-mui-toggle="dropdown" class="resmat-regular">
      Режим редагування <span class="mui-caret"></span>
    </a>
    <ul class="mui-dropdown__menu">
      <li *ngFor="let em of editingModes">
        <a (click)="changeEditingMode(em)"
           [ngClass]="{ 'selected-test-group-editing-mode': selectedEditingMode.id === em.id }"
           class="resmat-regular">
          {{ em.text }}
        </a>
      </li>
    </ul>
  </div>
</div>

<ul class="mui-tabs__bar mui-tabs__bar--justified" style="margin-top: -10px">
  <li [ngClass]="{ 'mui--is-active': activeTab === tabs.tests }" class="tab resmat-tab">
    <a (click)="switchTab(tabs.tests)">Тести</a>
  </li>
  <li [ngClass]="{ 'mui--is-active': activeTab === tabs.upload }"
      class="tab resmat-tab"
      *ngIf="selectedEditingMode.id === 'lightweight'">
    <a (click)="switchTab(tabs.upload)">Завантажити файл</a>
  </li>
  <li [ngClass]="{ 'mui--is-active': activeTab === tabs.hierarchy }" class="tab resmat-tab">
    <a (click)="switchTab(tabs.hierarchy)">Ієрархія груп</a>
  </li>
  <li [ngClass]="{ 'mui--is-active': activeTab === tabs.operations }" class="tab resmat-tab">
    <a (click)="switchTab(tabs.operations)">Дії</a>
  </li>
</ul>

<!--------------------- TESTS ---------------------->

<div [ngClass]="{ 'mui-tabs__pane': true, 'mui--is-active': activeTab === tabs.tests }" class="tab-content-container">
  <a [hidden]="selectedEditingMode.id === 'lightweight'"
     style="flex: 1; text-align: right;" (click)="editTestConf()"
     class="resmat-primary">Додати тест</a>
  <div *ngIf="selectedEditingMode.id === 'lightweight'" class="flex-container flex-column">
    <bulk-edit-test-conf-lightweight [isSaving]="workspaceData.isBulkSaving"
                                     [groupId]="workspaceData.data.id"
                                     [tests]="workspaceData.data.testConfs"
                                     (onSaved)="workspaceData.bulkUpdateTestConfs()"></bulk-edit-test-conf-lightweight>
  </div>
  <table *ngIf="selectedEditingMode.id === 'detailed'"
         class="mui-table mui-table--bordered"
         [hidden]="workspaceData.data.testConfs.length === 0">
    <tr *ngFor="let t of workspaceData.data.testConfs; let idx = index;">
      <td style="width: 5px">{{ idx + 1 }}.</td>
      <td>
        <test-conf-preview [test]="t"
                           (onEdit)="editTestConf($event.id)"
                           (onDelete)="deleteTestConf($event.id)"></test-conf-preview>
      </td>
    </tr>
  </table>
</div>

<!--------------------- UPLOAD ---------------------->

<div [ngClass]="{ 'mui-tabs__pane': true, 'mui--is-active': activeTab === tabs.upload }" class="tab-content-container">
  <div class="flex-container flex-column">
    <upload
      [path]="''"
      [auto]="false"
      [onlyImages]="false"
      [addToQueueWhenAdded]="false"
      (onAdded)="fileAdded($event)" class="flex-1"></upload>
    <div>
      <p>Тести можна завантажити із файлу .docx (Microsoft Word).</p>
      <p>Система розпізнає текст за наступними правилами:</p>
      <ol>
        <li><b>Запитання</b> тесту може бути або елементом нумерованого списку <b>(числа)</b> або абзацем який починається з <b>ЧИСЛА</b> з дужкою або крапкою.</li>
        <li><b>Варіант відповіді</b> може бути або елементом нумерованого списку <b>(букви)</b> або абзацем який починається з <b>БУКВИ</b> з дужкою або крапкою.</li>
      </ol>
      <p>Решта документу ігнорується</p>
      <a href="https://drive.google.com/file/d/1G6t6-OfoGgPWy5WgmypFycgKNTRLTghb/view?usp=sharing" target="_blank">Приклад</a>
      <p>Зверніть увагу - документи які містять зображення і формули не підримуються і можуть видавати неочікувані результати.</p>
    </div>
  </div>
</div>

<!--------------------- HIERARCHY ---------------------->

<div [ngClass]="{ 'mui-tabs__pane': true, 'mui--is-active': activeTab === tabs.hierarchy }" class="tab-content-container">
  <div class="mui-textfield parent-group-dropdown">
    <dropdown
      [options]="workspaceData.parentGroupOptions"
      [selectedOptionId]="workspaceData.selectedParentGroupId"
      [maxWidthPx]="1000"
      (onSelected)="workspaceData.parentGroupChanged($event)"></dropdown>
    <label>Батьківська група</label>
  </div>
  <div class="mui-textfield" *ngIf="workspaceData.data.childGroups.length">
    <p style="margin-bottom: 0.5em"></p>
    <test-group-list
      [groups]="workspaceData.data.childGroups"
      (onGroupClicked)="onLoadTestGroupConf.emit($event)"></test-group-list>
    <label>Підгрупи:</label>
  </div>
</div>

<!--------------------- OPERATIONS ---------------------->

<div [ngClass]="{ 'mui-tabs__pane': true, 'mui--is-active': activeTab === tabs.operations }" class="tab-content-container">
  <div>
    <button class="mui-btn mui-btn--success" (click)="workspaceData.archiveTestGroup()">Заархівувати групу</button>
  </div>
</div>
